import { $APP, shadow$provide } from "./common.js";
var UI=function(){var a=$APP.Lm(1);$APP.om(function(){var b=function(){function d(e){var f=e[1];if(f===7){var g=e[7];f=$APP.u(PI);f=!$APP.Od(f,g);e[8]=f;e[1]=f?10:11;return $APP.Z}if(f===1)return f=$APP.u(QI),f=$APP.Dh(f),g=$APP.D(f),e[9]=g,e[2]=null,e[1]=2,$APP.Z;if(f===4){g=e[9];g=$APP.E(g);f=$APP.Wz.g(g);g=$APP.mz.g(g);var h=$APP.u(RI);h=$APP.Df(h,new $APP.U(null,2,5,$APP.V,[g,$APP.Wz],null));e[10]=f;e[7]=g;e[11]=h;e[1]=$APP.n(g)?7:8;return $APP.Z}if(f===15)return e[2]=e[2],e[1]=6,$APP.Z;if(f===
13){g=e[7];f=$APP.X.u(SI,$APP.W,g,$APP.Fg);g=$APP.$m(TI,g,$APP.Ll(SI,new $APP.U(null,1,5,$APP.V,[g],null)));h=$APP.X.u(PI,$APP.W,g.group,g.cache);var m=g.ec;e[13]=f;e[12]=g;e[14]=h;return $APP.Im(e,16,m)}return f===6?(e[2]=e[2],e[1]=3,$APP.Z):f===3?$APP.Jm(e,e[2]):f===12?(e[2]=e[2],e[1]=9,$APP.Z):f===2?(g=e[9],f=$APP.D(g),e[1]=f?4:5,$APP.Z):f===11?(f=e[8],e[2]=f,e[1]=12,$APP.Z):f===9?(e[1]=$APP.n(e[2])?13:14,$APP.Z):f===5?(e[2]=null,e[1]=6,$APP.Z):f===14?(g=e[9],g=$APP.Mc(g),e[9]=g,e[2]=null,e[1]=
2,$APP.Z):f===16?(g=e[9],h=e[12],f=e[2],g=$APP.Mc(g),h=$APP.u(h),h=$APP.Dh(h),h=$APP.D(h),g=$APP.yf.h(g,h),e[15]=f,e[9]=g,e[2]=null,e[1]=2,$APP.Z):f===10?(h=e[11],f=$APP.J.h(h,"ckt"),e[2]=f,e[1]=12,$APP.Z):f===8?(g=e[7],e[2]=g,e[1]=9,$APP.Z):null}return function(){function e(h){for(;;){a:{try{for(;;){var m=d(h);if(!$APP.Q(m,$APP.Z)){var p=m;break a}}}catch(q){p=q;h[2]=p;if($APP.D(h[4]))h[1]=$APP.E(h[4]);else throw p;p=$APP.Z;break a}p=void 0}if(!$APP.Q(p,$APP.Z))return p}}function f(){var h=[null,
null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];h[0]=g;h[1]=1;return h}var g=null;g=function(h){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,h)}throw Error("Invalid arity: "+arguments.length);};g.m=f;g.g=e;return g}()}(),c=function(){var d=b();d[6]=a;return d}();return $APP.Hm(c)})},VI=new $APP.P("nyancad.mosaic.anywidget","anywidget-sync","nyancad.mosaic.anywidget/anywidget-sync",-1693447253);var WI=new URLSearchParams(window.location.search),XI,YI=WI.get("schem");XI=$APP.n(YI)?YI:"myschem";var ZI=WI.get("db"),TI=new $APP.kA($APP.n(ZI)?ZI:"schematics"),SI=$APP.Jl($APP.Xe([XI,$APP.R,"models",$APP.R])),QI=$APP.$m(TI,XI,$APP.Ll(SI,new $APP.U(null,1,5,$APP.V,[XI],null))),RI=$APP.$m(TI,"models",$APP.Ll(SI,new $APP.U(null,1,5,$APP.V,["models"],null))),$I=$APP.$m(TI,[$APP.r.g(XI),"$result"].join(""),$APP.Jl($APP.zh())),PI=$APP.Ym(TI,$APP.M([QI,RI,$I]));export const render=function(a){var b=a.model;a.el.innerHTML="Connected to editor.";b.set("schematic_data",$APP.ql($APP.u(SI)));b.set("name",XI);b.save_changes();$APP.Bi(SI,VI,function(c,d,e,f){$APP.wi($APP.M(["Schematic updated, syncing to anywidget model"]));UI();b.set("schematic_data",$APP.ql(f));return b.save_changes()});b.on("change:simulation_data",function(){var c=$APP.Li(b.get("simulation_data"),$APP.M([$APP.Ji,!0])),d=(new Date).toISOString();d=[$APP.r.g(XI),"$result:",$APP.r.g(d)].join("");
$APP.wi($APP.M(["Received simulation data from Python, storing with key:",d]));return $APP.X.u($I,$APP.W,d,c)});return null};