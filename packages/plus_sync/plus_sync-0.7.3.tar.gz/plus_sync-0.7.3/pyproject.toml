[project]
name = "plus_sync"
dynamic = ["version"]
description = "Convenient command line tool to sync all kind of data."
readme = "README.md"
authors = [{name = "Thomas Hartmann", email = "thomas.hartmann@th-ht.de"}]
requires-python = ">= 3.9"
dependencies = [ "tomlkit", "click", "paramiko>=4.0.0,<5", "attrs>=25.3.0,<26", "cattrs>=25.1.1,<26", "attrs-strict>=1.0.1,<2", "typer>=0.16.1,<0.17", "python-gitlab>=6.3.0,<7", "tqdm>=4.67.1,<5", "joblib>=1.5.2,<2", "quickxorhash>=1.0.5,<2", "factory-boy>=3.3.3,<4"]
license = { text = "GPL-3.0" }

[project.scripts]
plus_sync = "plus_sync.cmd:app"

[project.entry-points.pytest11]
plus_sync = "plus_sync.pytest.plugin"

[build-system]
requires = ["hatchling", "hatch-regex-commit"]
build-backend = "hatchling.build"

[tool.pixi.project]
channels = ["conda-forge"]
platforms = ["linux-64", "osx-64", "win-64", "osx-arm64"]

[tool.pixi.pypi-dependencies]
plus_sync = { path = ".", editable = true }
pytest-sftpserver = ">=1.3.0, <2"
id = ">=1.5.0, <2"

[tool.pixi.tasks]
test = "pytest"
lint = "ruff format && ruff check --fix"
lint_ci = "ruff check"
test_all = { depends-on = ["lint", "check_types", "test"] }
build = { cmd = "hatch build", depends-on = ["lint_ci", "test"] }
version_minor = "hatch version minor && hatch version dev"
version_fix = "hatch version fix && hatch version dev"
check_types = "mypy src"

[tool.pixi.dependencies]
hatch = ">=1.14.1,<2"
hatch-vcs = ">=0.5.0,<0.6"
ipython = ">=9.4.0,<10"
ipykernel = ">=6.30.1,<7"
ruff = ">=0.12.10,<0.13"
pre-commit = ">=4.3.0,<5"
pytest = ">=8.4.1,<9"
pytest-cov = ">=6.2.1,<7"
mypy = ">=1.17.1,<2"
types-tqdm = ">=4.67.0.20250809,<5"
types-paramiko = ">=4.0.0.20250822,<5"
click = ">=8.2.1,<9"

[tool.pixi.build-dependencies]
cxx-compiler = "*"

[tool.hatch.version]
source = "regex_commit"
path = "src/plus_sync/__version__.py"
tag_sign = false

[tool.hatch.envs.hatch-test]
extra-dependencies = [
    "factory_boy",
    "pytest-sftpserver"
]

[tool.ruff]
line-length = 120

[tool.ruff.lint]
extend-select = [
    'E',
    'W',
    'I',
    'UP',
    'C90',
    'N',
    'PTH',
    'SIM',
    'TCH',
    'PL'
]

[tool.ruff.format]
quote-style = 'single'

[tool.mypy]
disable_error_code = "import-untyped"
disallow_untyped_defs = false

[[tool.mypy.overrides]]
module = "plus_sync.*"
disallow_untyped_defs = true

[tool.pytest.ini_options]
addopts = "--cov=src --cov-append"
