[project]
name = "eip712-clearsign"
description = "ERC-7730 descriptors validation and utilities."
authors = [
    { name = "Ledger" },
]
maintainers = [
    { name = "Ledger" },
]
license = "MIT"
readme = "README.md"
dynamic = []
requires-python = ">= 3.12, <3.13"
classifiers = [
    "Development Status :: 5 - Production/Stable",
    "Intended Audience :: Developers",
    "Topic :: Software Development :: Libraries",
    "License :: OSI Approved :: MIT License",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3 :: Only",
    "Programming Language :: Python :: 3.12",
    "Typing :: Typed",
]
dependencies = [
    "pydantic>=2.8.2",
]
version = "4.1.0"

[project.urls]
Homepage = "https://ledgerhq.github.io/python-eip712"
Documentation = "https://ledgerhq.github.io/python-eip712"
Repository = "https://github.com/LedgerHQ/python-eip712"

[build-system]
requires = [
    "pdm-pep517>=1.0.0",
]
build-backend = "pdm.pep517.api"

[tool.pdm]
plugins = [
    "sync-pre-commit-lock",
    "pdm-packer",
]

[tool.pdm.scripts.lint]
help = "Run all linters/formatters (automatically run by pre-commit)"
shell = "pre-commit run --all-files"

[tool.pdm.scripts.test]
help = "Run unit/integration tests suite"
shell = "pytest tests"

[tool.pdm.scripts.all]
help = "Run lint+test"

[tool.pdm.scripts.all.shell]
composite = [
    "lint",
    "test",
]

[tool.pdm.scripts.exe]
help = "Package the application into a standalone executable"
shell = "pdm pack --compress --exe --interpreter '/usr/bin/env python3' --output eip712"

[tool.pdm.dev-dependencies]
dev = [
    "setuptools>=73.0.1",
    "pre-commit>=3.8.0",
    "pytest>=8.3.2",
    "pytest-cov>=5.0.0",
    "ruff>=0.6.3",
]

[tool.pdm.version]
source = "scm"
write_to = "eip712/VERSION"

[tool.pytest.ini_options]
testpaths = [
    "tests",
]
addopts = [
    "-v",
    "-Werror",
    "--basetemp=tmp",
    "--junitxml=tests/.tests.xml",
    "--cov=src",
    "--cov-report=xml:tests/.coverage.xml",
    "--cov-report=term",
    "--cov-branch",
]

[tool.coverage.paths]
source = [
    "src",
]

[tool.coverage.run]
omit = [
    "tests/*",
]

[tool.ruff]
line-length = 120

[tool.ruff.lint]
select = [
    "E",
    "F",
    "N",
    "UP",
    "B",
    "SIM",
    "I",
    "TID",
    "RUF",
]

[tool.mypy]
plugins = [
    "pydantic.mypy",
]
follow_imports = "silent"
warn_redundant_casts = true
warn_unused_ignores = true
disallow_any_generics = true
check_untyped_defs = true
disallow_untyped_defs = true

[tool.pydantic-mypy]
init_forbid_extra = true
init_typed = true
warn_required_dynamic_aliases = true

[tool.bandit]
exclude_dirs = [
    "tests",
]

[tool.codespell]
ignore-words = ".codespellignore"
skip = "pdm.lock"
