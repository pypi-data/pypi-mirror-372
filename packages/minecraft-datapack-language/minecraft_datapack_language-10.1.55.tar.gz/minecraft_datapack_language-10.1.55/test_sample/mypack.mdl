// mypack.mdl - minimal example for Minecraft Datapack Language (JavaScript-style)
# Using modern JavaScript-style MDL format (v10+)
pack "Test Pack" description "Example datapack" pack_format 82;
namespace "example";

function "inner" {
    say [example:inner] This is the inner function;
    tellraw @a {"text":"Running inner","color":"yellow"};
}

function "hello" {
    say [example:hello] Outer says hi;
    function example:inner;
    tellraw @a {"text":"Back in hello","color":"aqua"};
}

// Conditional example - detect different entity types with enhanced logic
function "conditional_demo" {
    if "entity @s[type=minecraft:player]" {
        say Player detected!;
        effect give @s minecraft:glowing 5 1;
        tellraw @a {"text":"A player is nearby!","color":"green"};
    } else if "entity @s[type=minecraft:zombie]" {
        say Zombie detected!;
        effect give @s minecraft:poison 5 1;
        tellraw @a {"text":"A zombie is nearby!","color":"red"};
    } else if "entity @s[type=minecraft:creeper]" {
        say Creeper detected!;
        effect give @s minecraft:resistance 5 1;
        tellraw @a {"text":"A creeper is nearby!","color":"dark_red"};
    } else {
        say Unknown entity detected;
        tellraw @a {"text":"Something unknown is nearby...","color":"gray"};
    }
}

// Advanced conditional example - weapon effects system
function "weapon_effects" {
    if "entity @s[type=minecraft:player,nbt={SelectedItem:{id:'minecraft:diamond_sword'}}]" {
        say Diamond sword detected!;
        effect give @s minecraft:strength 10 1;
        effect give @s minecraft:glowing 10 0;
    } else if "entity @s[type=minecraft:player,nbt={SelectedItem:{id:'minecraft:golden_sword'}}]" {
        say Golden sword detected!;
        effect give @s minecraft:speed 10 1;
        effect give @s minecraft:night_vision 10 0;
    } else if "entity @s[type=minecraft:player]" {
        say Player without special weapon;
        effect give @s minecraft:haste 5 0;
    } else {
        say No player found;
    }
}

// Variable system example
var num global_counter = 0;
var str global_message = "Hello World";

function "variable_demo" {
    var num local_counter = 10;
    var str player_name = "Steve";
    
    local_counter = local_counter + 5;
    global_counter = global_counter + 1;
    
    player_name = "Alex";
    global_message = "Updated: " + player_name;
    
    if "score @s test:local_counter matches 15" {
        say Counter is 15!;
    }
}

// Hook the function into load and tick
on_load "example:hello";
on_tick "example:hello";
on_tick "example:conditional_demo";
on_tick "example:weapon_effects";
on_tick "example:variable_demo";

// Second namespace with a cross-namespace call
namespace "util";

function "helper" {
    say [util:helper] Helping out...;
}

function "boss" {
    say [util:boss] Calling example:hello then util:helper;
    function example:hello;
    function util:helper;
}

// Run boss every tick as well
on_tick "util:boss";

// Function tag examples
tag function "minecraft:load" {
    add "example:hello";
}

tag function "minecraft:tick" {
    add "example:hello";
    add "example:conditional_demo";
    add "example:weapon_effects";
    add "example:variable_demo";
    add "util:boss";
}

// Data tag examples across registries
tag item "example:swords" {
    add "minecraft:diamond_sword";
    add "minecraft:netherite_sword";
}

tag block "example:glassy" {
    add "minecraft:glass";
    add "minecraft:tinted_glass";
}
