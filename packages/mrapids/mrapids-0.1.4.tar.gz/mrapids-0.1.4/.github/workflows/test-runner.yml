name: Test Self-Hosted Runner

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  test-runner:
    name: Test AWS Self-Hosted Runner
    runs-on: self-hosted
    steps:
      - name: Check Runner Info
        run: |
          echo "ðŸš€ Testing self-hosted runner on AWS"
          echo "Runner name: ${{ runner.name }}"
          echo "Runner OS: ${{ runner.os }}"
          echo "Runner Arch: ${{ runner.arch }}"
          
      - name: Check System Info
        run: |
          echo "=== System Information ==="
          uname -a
          echo ""
          echo "=== CPU Info ==="
          lscpu | head -10
          echo ""
          echo "=== Memory Info ==="
          free -h
          echo ""
          echo "=== Disk Usage ==="
          df -h
          
      - name: Check Available Tools
        run: |
          echo "=== Checking installed tools ==="
          echo "Docker version:"
          docker --version || echo "Docker not installed"
          echo ""
          echo "Git version:"
          git --version
          echo ""
          echo "Node version:"
          node --version || echo "Node not installed"
          echo ""
          echo "Python version:"
          python3 --version || echo "Python3 not installed"
          echo ""
          echo "Rust version:"
          rustc --version || echo "Rust not installed"
          cargo --version || echo "Cargo not installed"
          
      - uses: actions/checkout@v4
      
      - name: List Repository Files
        run: |
          echo "=== Repository structure ==="
          ls -la
          
      - name: Success Message
        run: |
          echo "âœ… Self-hosted runner is working correctly!"
          echo "Ready to run CI/CD pipelines on AWS infrastructure"