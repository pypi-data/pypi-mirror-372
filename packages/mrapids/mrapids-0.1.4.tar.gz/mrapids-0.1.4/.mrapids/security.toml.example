# MicroRapid Security Configuration
# Copy this file to .mrapids/security.toml to customize security settings

[network]
# Schemes allowed for API calls
allowed_schemes = ["https", "http"]

# Ports allowed for connections
allowed_ports = [80, 443, 8080, 8443, 3000, 8000]

# Maximum redirects to follow
max_redirects = 5

# Blocked IP ranges (CIDR notation)
# These protect against SSRF attacks
blocked_cidrs = [
    "127.0.0.0/8",      # Localhost
    "10.0.0.0/8",       # Private network Class A
    "172.16.0.0/12",    # Private network Class B
    "192.168.0.0/16",   # Private network Class C
    "169.254.0.0/16",   # Link-local
    "::1/128",          # IPv6 localhost
    "fc00::/7",         # IPv6 private
]

[files]
# Directories where files can be read (relative to project root)
allowed_read_dirs = [".", "./config", "./specs", "./examples"]

# Directories where files can be written (relative to project root)
allowed_write_dirs = ["./output", "./generated", "./.mrapids", "./tmp"]

# File extensions allowed for reading
allowed_extensions = [".yaml", ".yml", ".json", ".toml", ".txt", ".md"]

[limits]
# Maximum response size in bytes (10MB default)
max_response_size = 10485760

# Request timeout in milliseconds (30s default)
request_timeout = 30000

# Maximum request body size in bytes (1MB default)
max_request_size = 1048576

# Maximum header size in bytes (8KB default)
max_header_size = 8192

[tls]
# Verify TLS certificates
verify = true

# Minimum TLS version (1.0, 1.1, 1.2, 1.3)
min_version = "1.2"