import{w as S,g as i}from"../chunks/B9NWxkPv.js";import{l as b}from"../chunks/snYJ8SMg.js";import{u as I}from"../chunks/C2RVOhm1.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as j,f as y,a as N,$,g as _,d as h}from"../chunks/Bzf_CGVu.js";import{e as P}from"../chunks/CGiUvFS7.js";import{c as L,a as k}from"../chunks/DudhA4Qw.js";import{i as D,s as E,a as T}from"../chunks/CMIc6HKa.js";import{p as x}from"../chunks/BoQGZ29z.js";import{g as w}from"../chunks/DVrGeszw.js";import{r as A}from"../chunks/H7C68rOM.js";import{S as O}from"../chunks/BE3_oRq-.js";const V=({dataset_id:n,sampleIndex:s,tagIds:v,annotationLabelIds:g,min_width:e,max_width:d,min_height:o,max_height:l,textEmbedding:m,metadataValues:u})=>{const r=S({isLoading:!1});return(async()=>{r.update(a=>({...a,isLoading:!0,error:void 0}));try{const a=await b({dataset_id:n,limit:3,offset:s<1?0:s-1,annotationLabelIds:g,tagIds:v,min_width:e,max_width:d,min_height:o,max_height:l,textEmbedding:m,metadataValues:u});let t;const p=s>0?a.data[0]:void 0;a.data.length>2&&(t=s==0?a.data[1]:a.data[2]),r.update(c=>({...c,isLoading:!1,sampleNext:t,samplePrevious:p,error:void 0}))}catch(a){r.update(t=>({...t,isLoading:!1,error:a.message||"Failed to load adjacent samples"}))}})(),r},z=async({parent:n,params:{dataset_id:s,sampleId:v,sampleIndex:g}})=>{var f,a,t,p,c;const{samplesSelectedTagsIds:e,samplesSelectedAnnotationLabelsIds:d,samplesDimensions:o,samplesTextEmbedding:l}=await n(),m=parseInt(g,10),{metadataValues:u}=I();return{sampleAdjacents:V({dataset_id:s,sampleIndex:m,tagIds:Array.from(i(e)),annotationLabelIds:Array.from(i(d)),min_width:(f=i(o))==null?void 0:f.min_width,max_width:(a=i(o))==null?void 0:a.max_width,min_height:(t=i(o))==null?void 0:t.min_height,max_height:(p=i(o))==null?void 0:p.max_height,textEmbedding:(c=i(l))==null?void 0:c.embedding,metadataValues:i(u)}),sampleIndex:m}},Y=Object.freeze(Object.defineProperty({__proto__:null,load:z},Symbol.toStringTag,{value:"Module"}));function F(n,s){j(s,!0);const[v,g]=E(),e=()=>T(_(o),"$sampleAdjacents",v),d=h(()=>x.data.sampleIndex),o=h(()=>x.data.sampleAdjacents),l=()=>{e().sampleNext&&w(A.toSample({sampleId:e().sampleNext.sample_id,datasetId:e().sampleNext.dataset_id,sampleIndex:_(d)+1}),{invalidateAll:!0})},m=()=>{e().samplePrevious&&w(A.toSample({sampleId:e().samplePrevious.sample_id,datasetId:e().samplePrevious.dataset_id,sampleIndex:_(d)-1}),{invalidateAll:!0})},u=t=>{switch(t.key){case"ArrowRight":l();break;case"ArrowLeft":m();break}};var r=L();P("keydown",$,u);var f=y(r);{var a=t=>{const p=h(()=>!!e().samplePrevious),c=h(()=>!!e().sampleNext);O(t,{get hasPrevious(){return _(p)},get hasNext(){return _(c)},onPrevious:m,onNext:l})};D(f,t=>{e()&&t(a)})}k(n,r),N(),g()}function Z(n){F(n,{})}export{Z as component,Y as universal};
