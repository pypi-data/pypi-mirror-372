import{P as Ct}from"./BzArsHZA.js";import"./CWj6FrbW.js";import{p as ut,f as at,n as Pt,a as lt,c as X,r as R,s as L,t as it,g as u,d as st,at as Rt,u as zt,P as et,F as W}from"./Bzf_CGVu.js";import{s as $}from"./CF3MLdDH.js";import{i as bt}from"./CMIc6HKa.js";import{I as Dt,D as wt,e as Mt,s as tt,F as gt,H as Vt,K as Yt,L as yt,T as ht,M as mt,B as ft}from"./CEsXP70Q.js";import{c as xt,a as A,t as K,d as Xt}from"./DudhA4Qw.js";import{s as It,r as Zt,p as At,a as Q,b as Tt}from"./BYXJJYwp.js";import{f as St,a as Gt}from"./DDZ-yUNZ.js";import{s as _t}from"./DTwAVzRw.js";import{o as Ft}from"./DVrGeszw.js";function qt(e,o){ut(o,!0);let a=Zt(o,["$$slots","$$events","$$legacy"]);Dt(e,It({name:"zoom-in"},()=>a,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(p,d)=>{var l=xt(),z=at(l);_t(z,()=>o.children??Pt),A(p,l)},$$slots:{default:!0}})),lt()}function Ut(e,o){ut(o,!0);let a=Zt(o,["$$slots","$$events","$$legacy"]);Dt(e,It({name:"zoom-out"},()=>a,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(p,d)=>{var l=xt(),z=at(l);_t(z,()=>o.children??Pt),A(p,l)},$$slots:{default:!0}})),lt()}const ke=e=>`${Ct}/sample/${e}`;var jt=K('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),Ht=K('<div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div>'),Lt=K('<div class="flex items-start gap-3"><span class="truncate text-sm font-medium"> </span> <pre class="min-w-[8rem] flex-1 overflow-x-auto whitespace-pre-wrap rounded bg-muted p-2 text-sm"> </pre></div>'),Nt=K('<div class="flex items-start gap-3"><span class="truncate text-sm font-medium"> </span> <span class="min-w-[8rem] flex-1 break-all text-sm"> </span></div>'),Ot=K('<div class="space-y-3 text-diffuse-foreground"></div>'),Wt=K("<!> <!>",1);function Ee(e,o){ut(o,!0);const a=At(o,"showCustomMetadata",3,!0),h=st(()=>[{id:"height",label:"Height:",value:St(o.sample.height)+"px"},{id:"width",label:"Width:",value:St(o.sample.width)+"px"},{id:"filename",label:"Filename:",value:o.sample.file_name},{id:"filepath",label:"Filepath:",value:o.sample.file_path_abs}]),p=st(()=>{const v=[];if(o.sample.metadata_dict&&typeof o.sample.metadata_dict=="object"&&"data"in o.sample.metadata_dict){const b=o.sample.metadata_dict.data;b&&typeof b=="object"&&Object.entries(b).forEach(([C,y])=>{const T=Gt(y),w=typeof y=="object"&&y!==null&&!Array.isArray(y);v.push({id:`metadata_${C}`,label:`${C}:`,value:T,isComplex:w})})}return v});var d=Wt(),l=at(d);wt(l,{title:"Sample details",children:(v,b)=>{var C=Ht();Mt(C,21,()=>u(h),({label:y,value:T,id:w})=>y,(y,T)=>{let w=()=>u(T).label,k=()=>u(T).value,S=()=>u(T).id;var s=jt(),B=at(s),D=X(B,!0);R(B);var m=L(B,2),E=X(m,!0);R(m),it(()=>{$(D,w()),tt(m,"data-testid",`sample-metadata-${S()}`),$(E,k())}),A(y,s)}),R(C),A(v,C)}});var z=L(l,2);{var x=v=>{wt(v,{title:"Metadata",children:(b,C)=>{var y=Ot();Mt(y,21,()=>u(p),({label:T,value:w,id:k,isComplex:S})=>T,(T,w)=>{let k=()=>u(w).label,S=()=>u(w).value,s=()=>u(w).id,B=()=>u(w).isComplex;var D=xt(),m=at(D);{var E=I=>{var V=Lt(),Y=X(V),N=X(Y,!0);R(Y);var O=L(Y,2),nt=X(O,!0);R(O),R(V),it(()=>{tt(Y,"title",k()),$(N,k()),$(nt,S())}),A(I,V)},P=I=>{var V=Nt(),Y=X(V),N=X(Y,!0);R(Y);var O=L(Y,2),nt=X(O,!0);R(O),R(V),it(()=>{tt(Y,"title",k()),$(N,k()),tt(O,"data-testid",`sample-metadata-${s()}`),$(nt,S())}),A(I,V)};bt(m,I=>{B()?I(E):I(P,!1)})}A(T,D)}),R(y),A(b,y)}})};bt(z,v=>{a()&&u(p).length>0&&v(x)})}A(e,d),lt()}function U(e){return typeof e=="string"?new gt([[document.querySelector(e)]],[document.documentElement]):new gt([[e]],Vt)}function Kt(e){let o;for(;o=e.sourceEvent;)e=o;return e}function J(e,o){if(e=Kt(e),o===void 0&&(o=e.currentTarget),o){var a=o.ownerSVGElement||o;if(a.createSVGPoint){var h=a.createSVGPoint();return h.x=e.clientX,h.y=e.clientY,h=h.matrixTransform(o.getScreenCTM().inverse()),[h.x,h.y]}if(o.getBoundingClientRect){var p=o.getBoundingClientRect();return[e.clientX-p.left-o.clientLeft,e.clientY-p.top-o.clientTop]}}return[e.pageX,e.pageY]}function Qt(e){return new gt([document.querySelectorAll(e)],[document.documentElement])}const pt={capture:!0,passive:!1};function vt(e){e.preventDefault(),e.stopImmediatePropagation()}function Jt(e){var o=e.document.documentElement,a=U(e).on("dragstart.drag",vt,pt);"onselectstart"in o?a.on("selectstart.drag",vt,pt):(o.__noselect=o.style.MozUserSelect,o.style.MozUserSelect="none")}function $t(e,o){var a=e.document.documentElement,h=U(e).on("dragstart.drag",null);o&&(h.on("click.drag",vt,pt),setTimeout(function(){h.on("click.drag",null)},0)),"onselectstart"in a?h.on("selectstart.drag",null):(a.style.MozUserSelect=a.__noselect,delete a.__noselect)}var te=1e-12;function kt(e){return((e=Math.exp(e))+1/e)/2}function ee(e){return((e=Math.exp(e))-1/e)/2}function ne(e){return((e=Math.exp(2*e))-1)/(e+1)}const oe=function e(o,a,h){function p(d,l){var z=d[0],x=d[1],v=d[2],b=l[0],C=l[1],y=l[2],T=b-z,w=C-x,k=T*T+w*w,S,s;if(k<te)s=Math.log(y/v)/o,S=function(I){return[z+I*T,x+I*w,v*Math.exp(o*I*s)]};else{var B=Math.sqrt(k),D=(y*y-v*v+h*k)/(2*v*a*B),m=(y*y-v*v-h*k)/(2*y*a*B),E=Math.log(Math.sqrt(D*D+1)-D),P=Math.log(Math.sqrt(m*m+1)-m);s=(P-E)/o,S=function(I){var V=I*s,Y=kt(E),N=v/(a*B)*(Y*ne(o*V+E)-ee(E));return[z+N*T,x+N*w,v*Y/kt(o*V+E)]}}return S.duration=s*1e3*o/Math.SQRT2,S}return p.rho=function(d){var l=Math.max(.001,+d),z=l*l,x=z*z;return e(l,z,x)},p}(Math.SQRT2,2,4),rt=e=>()=>e;function ae(e,{sourceEvent:o,target:a,transform:h,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:o,enumerable:!0,configurable:!0},target:{value:a,enumerable:!0,configurable:!0},transform:{value:h,enumerable:!0,configurable:!0},_:{value:p}})}function dt(e){e.stopImmediatePropagation()}function ot(e){e.preventDefault(),e.stopImmediatePropagation()}function ie(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function re(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Et(){return this.__zoom||yt}function se(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ue(){return navigator.maxTouchPoints||"ontouchstart"in this}function le(e,o,a){var h=e.invertX(o[0][0])-a[0][0],p=e.invertX(o[1][0])-a[1][0],d=e.invertY(o[0][1])-a[0][1],l=e.invertY(o[1][1])-a[1][1];return e.translate(p>h?(h+p)/2:Math.min(0,h)||Math.max(0,p),l>d?(d+l)/2:Math.min(0,d)||Math.max(0,l))}function ce(){var e=ie,o=re,a=le,h=se,p=ue,d=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],z=250,x=oe,v=Yt("start","zoom","end"),b,C,y,T=500,w=150,k=0,S=10;function s(t){t.property("__zoom",Et).on("wheel.zoom",V,{passive:!1}).on("mousedown.zoom",Y).on("dblclick.zoom",N).filter(p).on("touchstart.zoom",O).on("touchmove.zoom",nt).on("touchend.zoom touchcancel.zoom",Bt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}s.transform=function(t,i,n,r){var c=t.selection?t.selection():t;c.property("__zoom",Et),t!==c?E(t,i,n,r):c.interrupt().each(function(){P(this,arguments).event(r).start().zoom(null,typeof i=="function"?i.apply(this,arguments):i).end()})},s.scaleBy=function(t,i,n,r){s.scaleTo(t,function(){var c=this.__zoom.k,f=typeof i=="function"?i.apply(this,arguments):i;return c*f},n,r)},s.scaleTo=function(t,i,n,r){s.transform(t,function(){var c=o.apply(this,arguments),f=this.__zoom,g=n==null?m(c):typeof n=="function"?n.apply(this,arguments):n,_=f.invert(g),M=typeof i=="function"?i.apply(this,arguments):i;return a(D(B(f,M),g,_),c,l)},n,r)},s.translateBy=function(t,i,n,r){s.transform(t,function(){return a(this.__zoom.translate(typeof i=="function"?i.apply(this,arguments):i,typeof n=="function"?n.apply(this,arguments):n),o.apply(this,arguments),l)},null,r)},s.translateTo=function(t,i,n,r,c){s.transform(t,function(){var f=o.apply(this,arguments),g=this.__zoom,_=r==null?m(f):typeof r=="function"?r.apply(this,arguments):r;return a(yt.translate(_[0],_[1]).scale(g.k).translate(typeof i=="function"?-i.apply(this,arguments):-i,typeof n=="function"?-n.apply(this,arguments):-n),f,l)},r,c)};function B(t,i){return i=Math.max(d[0],Math.min(d[1],i)),i===t.k?t:new ht(i,t.x,t.y)}function D(t,i,n){var r=i[0]-n[0]*t.k,c=i[1]-n[1]*t.k;return r===t.x&&c===t.y?t:new ht(t.k,r,c)}function m(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function E(t,i,n,r){t.on("start.zoom",function(){P(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){P(this,arguments).event(r).end()}).tween("zoom",function(){var c=this,f=arguments,g=P(c,f).event(r),_=o.apply(c,f),M=n==null?m(_):typeof n=="function"?n.apply(c,f):n,q=Math.max(_[1][0]-_[0][0],_[1][1]-_[0][1]),Z=c.__zoom,G=typeof i=="function"?i.apply(c,f):i,j=x(Z.invert(M).concat(q/Z.k),G.invert(M).concat(q/G.k));return function(F){if(F===1)F=G;else{var H=j(F),ct=q/H[2];F=new ht(ct,M[0]-H[0]*ct,M[1]-H[1]*ct)}g.zoom(null,F)}})}function P(t,i,n){return!n&&t.__zooming||new I(t,i)}function I(t,i){this.that=t,this.args=i,this.active=0,this.sourceEvent=null,this.extent=o.apply(t,i),this.taps=0}I.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,i){return this.mouse&&t!=="mouse"&&(this.mouse[1]=i.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=i.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=i.invert(this.touch1[0])),this.that.__zoom=i,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var i=U(this.that).datum();v.call(t,this.that,new ae(t,{sourceEvent:this.sourceEvent,target:s,transform:this.that.__zoom,dispatch:v}),i)}};function V(t,...i){if(!e.apply(this,arguments))return;var n=P(this,i).event(t),r=this.__zoom,c=Math.max(d[0],Math.min(d[1],r.k*Math.pow(2,h.apply(this,arguments)))),f=J(t);if(n.wheel)(n.mouse[0][0]!==f[0]||n.mouse[0][1]!==f[1])&&(n.mouse[1]=r.invert(n.mouse[0]=f)),clearTimeout(n.wheel);else{if(r.k===c)return;n.mouse=[f,r.invert(f)],mt(this),n.start()}ot(t),n.wheel=setTimeout(g,w),n.zoom("mouse",a(D(B(r,c),n.mouse[0],n.mouse[1]),n.extent,l));function g(){n.wheel=null,n.end()}}function Y(t,...i){if(y||!e.apply(this,arguments))return;var n=t.currentTarget,r=P(this,i,!0).event(t),c=U(t.view).on("mousemove.zoom",M,!0).on("mouseup.zoom",q,!0),f=J(t,n),g=t.clientX,_=t.clientY;Jt(t.view),dt(t),r.mouse=[f,this.__zoom.invert(f)],mt(this),r.start();function M(Z){if(ot(Z),!r.moved){var G=Z.clientX-g,j=Z.clientY-_;r.moved=G*G+j*j>k}r.event(Z).zoom("mouse",a(D(r.that.__zoom,r.mouse[0]=J(Z,n),r.mouse[1]),r.extent,l))}function q(Z){c.on("mousemove.zoom mouseup.zoom",null),$t(Z.view,r.moved),ot(Z),r.event(Z).end()}}function N(t,...i){if(e.apply(this,arguments)){var n=this.__zoom,r=J(t.changedTouches?t.changedTouches[0]:t,this),c=n.invert(r),f=n.k*(t.shiftKey?.5:2),g=a(D(B(n,f),r,c),o.apply(this,i),l);ot(t),z>0?U(this).transition().duration(z).call(E,g,r,t):U(this).call(s.transform,g,r,t)}}function O(t,...i){if(e.apply(this,arguments)){var n=t.touches,r=n.length,c=P(this,i,t.changedTouches.length===r).event(t),f,g,_,M;for(dt(t),g=0;g<r;++g)_=n[g],M=J(_,this),M=[M,this.__zoom.invert(M),_.identifier],c.touch0?!c.touch1&&c.touch0[2]!==M[2]&&(c.touch1=M,c.taps=0):(c.touch0=M,f=!0,c.taps=1+!!b);b&&(b=clearTimeout(b)),f&&(c.taps<2&&(C=M[0],b=setTimeout(function(){b=null},T)),mt(this),c.start())}}function nt(t,...i){if(this.__zooming){var n=P(this,i).event(t),r=t.changedTouches,c=r.length,f,g,_,M;for(ot(t),f=0;f<c;++f)g=r[f],_=J(g,this),n.touch0&&n.touch0[2]===g.identifier?n.touch0[0]=_:n.touch1&&n.touch1[2]===g.identifier&&(n.touch1[0]=_);if(g=n.that.__zoom,n.touch1){var q=n.touch0[0],Z=n.touch0[1],G=n.touch1[0],j=n.touch1[1],F=(F=G[0]-q[0])*F+(F=G[1]-q[1])*F,H=(H=j[0]-Z[0])*H+(H=j[1]-Z[1])*H;g=B(g,Math.sqrt(F/H)),_=[(q[0]+G[0])/2,(q[1]+G[1])/2],M=[(Z[0]+j[0])/2,(Z[1]+j[1])/2]}else if(n.touch0)_=n.touch0[0],M=n.touch0[1];else return;n.zoom("touch",a(D(g,_,M),n.extent,l))}}function Bt(t,...i){if(this.__zooming){var n=P(this,i).event(t),r=t.changedTouches,c=r.length,f,g;for(dt(t),y&&clearTimeout(y),y=setTimeout(function(){y=null},T),f=0;f<c;++f)g=r[f],n.touch0&&n.touch0[2]===g.identifier?delete n.touch0:n.touch1&&n.touch1[2]===g.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(g=J(g,this),Math.hypot(C[0]-g[0],C[1]-g[1])<S)){var _=U(this).on("dblclick.zoom");_&&_.apply(this,arguments)}}}return s.wheelDelta=function(t){return arguments.length?(h=typeof t=="function"?t:rt(+t),s):h},s.filter=function(t){return arguments.length?(e=typeof t=="function"?t:rt(!!t),s):e},s.touchable=function(t){return arguments.length?(p=typeof t=="function"?t:rt(!!t),s):p},s.extent=function(t){return arguments.length?(o=typeof t=="function"?t:rt([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),s):o},s.scaleExtent=function(t){return arguments.length?(d[0]=+t[0],d[1]=+t[1],s):[d[0],d[1]]},s.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],s):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},s.constrain=function(t){return arguments.length?(a=t,s):a},s.duration=function(t){return arguments.length?(z=+t,s):z},s.interpolate=function(t){return arguments.length?(x=t,s):x},s.on=function(){var t=v.on.apply(v,arguments);return t===v?s:t},s.clickDistance=function(t){return arguments.length?(k=(t=+t)*t,s):Math.sqrt(k)},s.tapDistance=function(t){return arguments.length?(S=+t,s):S},s}function he(e,o){let a=e.scaleIndependentXForm;a||(a=e.scaleIndependentXForm=o.createSVGTransform(),e.transform.baseVal.appendItem(a));const h=e.parentNode;if(h){const p=h.getScreenCTM();if(p){const d=p.inverse().multiply(o.getScreenCTM());d.e=d.f=0,a.setMatrix(d)}}}var me=K('<div class="pointer-events-auto absolute bottom-0 left-1 z-20 flex select-none items-center gap-1 rounded-lg bg-muted bg-opacity-80 shadow-md backdrop-blur-sm"><!> <div class="h-6 w-px bg-white bg-opacity-20"></div> <!> <div class="w-[32px] text-center text-sm text-muted-foreground" data-testid="zoom-level"> </div> <!></div>');function fe(e,o){var a=me(),h=X(a);ft(h,{variant:"ghost","data-testid":"zoom-reset",size:"sm",get onclick(){return o.onZoomReset},get disabled(){return o.isResetDisabled},children:(x,v)=>{Rt();var b=Xt("Reset");A(x,b)},$$slots:{default:!0}});var p=L(h,4);ft(p,{title:"zoom out",variant:"ghost",size:"icon","data-testid":"zoom-out",get onclick(){return o.onZoomOut},get disabled(){return o.isZoominDisabled},children:(x,v)=>{Ut(x,{class:"h-4 w-4"})},$$slots:{default:!0}});var d=L(p,2),l=X(d);R(d);var z=L(d,2);ft(z,{title:"zoom in",variant:"ghost",size:"icon","data-testid":"zoom-in",get onclick(){return o.onZoomIn},get disabled(){return o.isZoomoutDisabled},children:(x,v)=>{qt(x,{class:"h-4 w-4"})},$$slots:{default:!0}}),R(a),it(x=>$(l,`${x??""}%`),[()=>Math.round(o.scale*100)]),A(e,a)}var de=K('<div class="relative flex h-full w-full select-none items-center justify-center"><!> <svg class="z-10 h-full w-full cursor-grab" preserveAspectRatio="xMidYMid meet"><g><!></g></svg> <svg class="pointer-events-none absolute inset-0" preserveAspectRatio="xMidYMid meet"></svg></div>');function Pe(e,o){ut(o,!0);let a=et(null),h=et(null),p=et(800),d=et(600);zt(()=>{if(!u(a))return;W(p,Q(u(a).clientWidth)),W(d,Q(u(a).clientHeight));const m=new ResizeObserver(()=>{u(a)&&(W(p,Q(u(a).clientWidth)),W(d,Q(u(a).clientHeight)))});return m.observe(u(a)),()=>m.disconnect()});const l=10,z=st(()=>{const m={x:0,y:0,width:o.width,height:o.height};if(o.boundingBox){const{x:E,y:P,width:I,height:V}=o.boundingBox;return{x:Math.round(Math.max(0,E-l)),y:Math.round(Math.max(0,P-l)),width:Math.round(Math.min(o.width-E,I+l*2)),height:Math.round(Math.min(o.height-P,V+l*2))}}return m});let x=et(Q({k:1,x:0,y:0}));const v=st(()=>{if(!u(a))return 1;const m=u(p)/o.width,E=u(d)/o.height,P=Math.min(m,E);return u(x).k*P});let b=et(null);const C=()=>{u(a)&&(W(b,Q(ce().on("zoom",m=>{W(x,Q(m.transform))}).filter(m=>(!m.ctrlKey||m.type==="wheel")&&!m.button&&!(m.type==="mousedown"&&m.button===2)).wheelDelta(m=>-m.deltaY*.002))),U(u(a)).call(u(b)).on("dblclick.zoom",null))},y=m=>{if(!u(a)||!u(b))return;const E=m?1.5:.75;U(u(a)).transition().duration(300).call(u(b).scaleBy,E)},T=()=>{!u(a)||!u(b)||U(u(a)).transition().duration(300).call(u(b).transform,yt)};Ft(()=>{C()}),zt(()=>{u(x).k,Qt(".unscaled").each(function(){he(this,u(h))})});var w=de(),k=X(w);fe(k,{get scale(){return u(v)},onZoomIn:()=>y(!0),onZoomOut:()=>y(!1),onZoomReset:T});var S=L(k,2),s=X(S),B=X(s);_t(B,()=>o.children),R(s),R(S),Tt(S,m=>W(a,m),()=>u(a));var D=L(S,2);tt(D,"viewBox","0 0 1024 768"),Tt(D,m=>W(h,m),()=>u(h)),R(w),it(()=>{tt(S,"viewBox",`${u(z).x} ${u(z).y} ${u(z).width} ${u(z).height}`),tt(s,"transform",`translate(${u(x).x}, ${u(x).y}) scale(${u(x).k})`)}),A(e,w),lt()}export{Ee as S,Pe as Z,ke as g};
