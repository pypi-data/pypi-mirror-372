%% Reward Shaping & Risk Penalties
flowchart TD

EQ[Equity(t)] --> DD[Compute Drawdown]
EQ --> RV[Realized Volatility]
OPEN[Open Notional] --> COST[Transaction Cost]
POS[Open Positions] --> RISK[Utilization Ratio]

DD --> RW[RewardShaper.compute]
RV --> RW
COST --> RW
RISK --> RW
PNL[Delta PnL] --> RW

CFG[Env Config\n- cost_weight\n- drawdown_penalty_weight\n- volatility_penalty_weight] --> RW

RW --> REWARD[Final Reward]
REWARD --> MON[Monitoring]
