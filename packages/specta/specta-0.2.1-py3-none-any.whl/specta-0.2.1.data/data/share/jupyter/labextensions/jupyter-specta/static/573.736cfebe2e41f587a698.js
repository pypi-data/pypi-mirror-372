"use strict";(self.webpackChunkjupyter_specta=self.webpackChunkjupyter_specta||[]).push([[573],{4573:(e,t,o)=>{o.r(t),o.d(t,{ISpectaDocTracker:()=>m,ISpectaLayoutRegistry:()=>h,createFileBrowser:()=>A,debounce:()=>$,default:()=>ie,emitResizeEvent:()=>Z,getSpectaAssetUrl:()=>U,hideAppLoadingIndicator:()=>B,isSpectaApp:()=>z,mergeObjects:()=>D,readCellConfig:()=>J,readSpectaConfig:()=>H,registerDocumentFactory:()=>q,setRevealTheme:()=>K});var n=o(9715),a=o(8864),s=o(2310),i=o(3427),l=o(438),r=o(8531),c=o(4100),d=o(1269),u=o(5256),p=o(7262);const h=new p.Token("specta:ISpectaLayoutRegistry"),m=new p.Token("exampleDocTracker");var g=o(8134),y=o(9159),v=o(3345),f=o.n(v);const w=e=>{var t=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(o[n[a]]=e[n[a]])}return o}(e,[]);return f().createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px"},t),f().createElement("path",{d:"m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"}))},b=(0,v.forwardRef)((({icon:e,onClick:t,title:o,disabled:n,className:a},s)=>f().createElement("button",{ref:s,className:`jp-Button specta-icon-button ${null!=a?a:""}`,title:o,disabled:n,onClick:t},e))),_=()=>f().createElement("div",{className:"specta-divider"}),C=e=>{var t,o,n,a,s,i,l;const{themeManager:r,layoutRegistry:c}=e,[d,u]=(0,v.useState)([...null!==(t=null==r?void 0:r.themes)&&void 0!==t?t:[]]),[p,h]=(0,v.useState)(null!==(o=null==r?void 0:r.theme)&&void 0!==o?o:"light"),[m,g]=(0,v.useState)(null!==(n=null==c?void 0:c.allLayouts())&&void 0!==n?n:[]),[y,w]=(0,v.useState)(null!==(s=null===(a=null==c?void 0:c.selectedLayout)||void 0===a?void 0:a.name)&&void 0!==s?s:"default");(0,v.useEffect)((()=>{let e;if(r&&(e=(e,t)=>{t.newValue.length>0||(u([...r.themes]),r.theme&&h(r.theme))},r.themeChanged.connect(e)),c){const e=(e,t)=>{g(c.allLayouts())};c.layoutAdded.connect(e)}return()=>{r&&e&&r.themeChanged.disconnect(e)}}),[r,c]);const b=(0,v.useCallback)((e=>{var t;const o=null===(t=e.currentTarget)||void 0===t?void 0:t.value;o&&(null==r||r.setTheme(o),h(o))}),[r]),C=(0,v.useCallback)((e=>{var t;const o=null===(t=e.currentTarget)||void 0===t?void 0:t.value;o&&c&&(c.setSelectedLayout(o),w(o))}),[c]);return f().createElement("div",{style:{padding:"0 10px"}},f().createElement("p",{style:{marginTop:0,marginBottom:"5px",fontSize:"1rem"}},"SETTINGS"),f().createElement(_,null),(void 0===(null===(i=e.config)||void 0===i?void 0:i.layoutToggle)||e.config.layoutToggle)&&c&&f().createElement("div",null,f().createElement("label",{htmlFor:""},"Select layout"),f().createElement("div",{className:"jp-select-wrapper"},f().createElement("select",{className:" jp-mod-styled specta-topbar-theme",onChange:C,value:y},m.map((e=>f().createElement("option",{key:e,value:e,style:{background:"var(--jp-layout-color2)"}},e.charAt(0).toUpperCase()+e.slice(1))))))),(void 0===(null===(l=e.config)||void 0===l?void 0:l.themeToggle)||e.config.themeToggle)&&r&&f().createElement("div",null,f().createElement("label",{htmlFor:""},"Select theme"),f().createElement("div",{className:"jp-select-wrapper"},f().createElement("select",{className:" jp-mod-styled specta-topbar-theme",onChange:b,value:p},d.map((e=>f().createElement("option",{key:e,value:e,style:{background:"var(--jp-layout-color2)"}},e)))))))};function k(e){var t,o,n;const a=f().useMemo((()=>{var t,o,n,a,s,i,l,r,c;return{background:null!==(o=null===(t=e.config)||void 0===t?void 0:t.background)&&void 0!==o?o:"var(--jp-layout-color2)",title:null!==(a=null===(n=e.config)||void 0===n?void 0:n.title)&&void 0!==a?a:"Specta",themeToggle:Boolean(null===(s=e.config)||void 0===s?void 0:s.themeToggle),kernelActivity:Boolean(null===(i=e.config)||void 0===i?void 0:i.kernelActivity),textColor:null!==(r=null===(l=e.config)||void 0===l?void 0:l.textColor)&&void 0!==r?r:"var(--jp-ui-font-color1)",icon:null===(c=e.config)||void 0===c?void 0:c.icon}}),[e.config]),[s,i]=(0,v.useState)(!1),l=(0,v.useRef)(null),r=(0,v.useRef)(null);return(0,v.useEffect)((()=>{const e=e=>{r.current&&!r.current.contains(e.target)&&l.current&&!l.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]),f().createElement("div",{className:"specta-topbar",style:{background:null!==(t=a.background)&&void 0!==t?t:"var(--jp-layout-color2)"}},f().createElement("div",{className:"specta-topbar-left"},f().createElement("div",{className:"specta-topbar-icon-container"},a.icon&&f().createElement("img",{style:{height:"100%"},src:a.icon})),f().createElement("div",{className:"specta-topbar-title",style:{color:null!==(o=a.textColor)&&void 0!==o?o:"var(--jp-ui-font-color1)"}},a.title)),(void 0===(null===(n=e.config)||void 0===n?void 0:n.settingsButton)||e.config.settingsButton)&&f().createElement("div",{className:"specta-topbar-right"},f().createElement(b,{ref:l,onClick:()=>i(!s),icon:f().createElement(w,{fill:"var(--jp-ui-font-color2)",height:23,width:23})}),s&&f().createElement("div",{ref:r,className:"jp-Dialog-content specta-config-dialog"},f().createElement("div",{className:"specta-config-arrow"}),f().createElement(C,{config:e.config,themeManager:e.themeManager}))))}class E extends g.DocumentWidget{constructor(e){super(e)}dispose(){this.content.dispose(),super.dispose()}}class S extends g.ABCWidgetFactory{constructor(e){super(e),this._spectaWidgetFactory=e.spectaWidgetFactory,this._shell=e.shell,this._themeManager=e.themeManager,this._layoutRegistry=e.spectaLayoutRegistry}createNewWidget(e){const t=new u.Panel;return t.addClass("jp-specta-notebook-panel"),e.ready.then((async()=>{var o;const n=null===(o=e.contentsModel)||void 0===o?void 0:o.path,a=H({nbMetadata:e.model.metadata,nbPath:n}),s=z();if(a.hideTopbar)s&&this._shell.hideTopBar();else{const e=y.ReactWidget.create(v.createElement(k,{config:a.topBar,themeManager:this._themeManager,layoutRegistry:this._layoutRegistry}));e.addClass("specta-topbar-element"),s?(e.id="specta-topbar-widget",this._shell.add(e,"top")):t.addWidget(e)}const i=await this._spectaWidgetFactory.createNew({context:e});i&&t.addWidget(i)})),new E({context:e,content:t})}}var x,O=o(494),L=o(8547);class T extends g.Context{async save(){await this.ready}async saveAs(){await this.ready}async revert(){await this.ready}}function M({bars:e=5}){return f().createElement("div",{className:"skeleton-bar-chart vertical"},f().createElement("div",{className:"skeleton-label"},"Executing cell"),Array.from({length:e}).map(((e,t)=>f().createElement("div",{key:t,className:"bar vertical-bar",style:{animationDelay:.4*t+"s"}}))))}function N(){return f().createElement("div",{className:"skeleton-line-chart"},f().createElement("div",{className:"skeleton-label"},"Executing cell"),f().createElement("svg",{viewBox:"0 0 100 40",preserveAspectRatio:"none"},f().createElement("polyline",{points:"0,30 20,20 40,25 60,15 80,10 100,20"})))}function P(){return Math.random()<.5?f().createElement(N,null):f().createElement(M,null)}class j extends u.Panel{constructor({cellIdentity:e,cell:t,sourceCell:o,info:n,cellConfig:a}){var s;super(),this._info={},this._placeholder=void 0,this.removeClass("lm-Widget"),this.removeClass("p-Widget"),this.addClass("specta-cell-output");const i=new u.Panel;i.addClass("specta-cell-content"),t.addClass("specta-item-widget"),o&&i.addWidget(o),i.addWidget(t),this.addWidget(i),this._cellOutput=t,this.cellIdentity=e,this._info=null!=n?n:{},"code"===(null===(s=n.cellModel)||void 0===s?void 0:s.cell_type)&&a.showOutput&&(this._placeholder=y.ReactWidget.create(f().createElement(P,null)),this._placeholder.addClass("specta-cell-placeholder"),this.addWidget(this._placeholder))}get cellOutput(){return this._cellOutput}get info(){return this._info}removePlaceholder(){var e;this._placeholder&&(null===(e=this._placeholder)||void 0===e||e.dispose())}}class R{constructor(e){this.options=e,this._isDisposed=!1,this._notebookModelJson=e.context.model.toJSON(),this._kernelPreference={shouldStart:!0,canStart:!0,shutdownOnDispose:!0,name:e.context.model.defaultKernelName,autoStartDefault:!0,language:e.context.model.defaultKernelLanguage},this._manager=e.manager}get isDisposed(){return this._isDisposed}dispose(){var e,t;this.isDisposed||(this._isDisposed=!0,null===(e=this._context)||void 0===e||e.dispose(),null===(t=this._notebookPanel)||void 0===t||t.dispose())}get rendermime(){return this.options.rendermime}get cells(){var e;return null===(e=this._context)||void 0===e?void 0:e.model.cells}get context(){return this._context}get panel(){return this._notebookPanel}async initialize(){this._context=await async function(e){const t=new r.NotebookModelFactory({disableDocumentWideUndoRedo:!1}),{manager:o,kernelPreference:n}=e,a=p.UUID.uuid4()+".ipynb";return await o.ready,await o.kernelspecs.ready,new T({manager:o,factory:t,path:a,kernelPreference:n})}({manager:this._manager,kernelPreference:this._kernelPreference}),this._context.model.fromJSON(this._notebookModelJson),this._notebookPanel=function(e){const{context:t,rendermime:o,editorServices:n}=e,a=n.factoryService.newInlineEditor,s=new r.Notebook({rendermime:o,contentFactory:new r.Notebook.ContentFactory({editorFactory:a}),mimeTypeService:n.mimeTypeService});return new r.NotebookPanel({content:s,context:t})}({context:this._context,rendermime:this.options.rendermime,editorServices:this.options.editorServices}),this.options.tracker.add(this._notebookPanel),await this._context.sessionContext.initialize()}createCell(e){let t;const o=e.toJSON(),n={cellModel:o},a=J(o);switch(e.type){case"code":{let o;a.showSource&&(o=new O.CodeCell({model:e,rendermime:this.options.rendermime,contentFactory:this.options.contentFactory,editorConfig:{lineNumbers:!1,lineWrap:!1,tabFocusable:!1,editable:!1}}),o.syncEditable=!1,o.readOnly=!0);const s=new L.OutputAreaModel({trusted:!0}),i=new L.SimplifiedOutputArea({model:s,rendermime:this.options.rendermime});t=new j({cellIdentity:e.id,cell:i,sourceCell:o,cellConfig:a,info:n});break}case"markdown":{const o=new O.MarkdownCell({model:e,rendermime:this.options.rendermime,contentFactory:this.options.contentFactory,editorConfig:this.options.editorConfig.markdown});o.initializeState(),o.inputHidden=!1,o.rendered=!0,x.removeElements(o.node,"jp-Collapser"),x.removeElements(o.node,"jp-InputPrompt"),t=new j({cellIdentity:e.id,cell:o,info:n,cellConfig:a});break}default:{const o=new O.RawCell({model:e,contentFactory:this.options.contentFactory,editorConfig:this.options.editorConfig.raw});o.inputHidden=!1,x.removeElements(o.node,"jp-Collapser"),x.removeElements(o.node,"jp-InputPrompt"),t=new j({cellIdentity:e.id,cell:o,info:n,cellConfig:a});break}}return t}async executeCell(e,t){if("code"!==e.type||!this._context)return;const o=t.cellOutput,n=e.sharedModel.source,a=await L.SimplifiedOutputArea.execute(n,o,this._context.sessionContext);return o.future.done.then((()=>{Z(),t.removePlaceholder()})),a}}!function(e){e.removeElements=function(e,t){const o=e.getElementsByClassName(t);for(let e=0;e<o.length;e++)o[e].remove()}}(x||(x={}));class W extends u.Panel{constructor(e){super(),this._ready=new p.PromiseDelegate,this._outputs=[],this.node.id=e.id,this.title.label=e.label,this.title.closable=!0,this._model=e.model,this._spectaAppConfig=e.spectaConfig,this._layoutRegistry=e.layoutRegistry,this._host=new u.Panel,this._host.addClass("specta-output-host"),this.addClass("specta-app-widget"),this.addWidget(this._host),z()||this.addSpinner(),this._model.initialize().then((()=>{this.render().catch(console.error).then(Z)})),this._layoutRegistry.selectedLayoutChanged.connect(this._onSelectedLayoutChanged,this)}get ready(){return this._ready.promise}get model(){return this._model}addSpinner(){const e=this._loaderHost=new u.Widget;e.addClass("specta-loader-host");const t=document.createElement("div");t.className="specta-loader",e.node.appendChild(t);const o=document.createElement("div");o.className="specta-loading-indicator-text",o.textContent="Loading Specta",e.node.appendChild(o),this.addWidget(e)}dispose(){this.isDisposed||(this._model.dispose(),super.dispose())}async render(){var e,t,o,n,a;const s=null!==(e=this._model.cells)&&void 0!==e?e:[],i=null!==(o=null===(t=this._spectaAppConfig)||void 0===t?void 0:t.defaultLayout)&&void 0!==o?o:"default";for(const e of s){if(0===e.sharedModel.source.length)continue;const t=this._model.createCell(e);this._model.executeCell(e,t),this._outputs.push(t)}const l=null!==(n=this._layoutRegistry.get(i))&&void 0!==n?n:this._layoutRegistry.getDefaultLayout();await l.render({host:this._host,items:this._outputs,notebook:null===(a=this._model.context)||void 0===a?void 0:a.model.toJSON(),readyCallback:async()=>{this._loaderHost?(this._loaderHost.node.style.opacity="0",setTimeout((()=>{var e;null===(e=this.layout)||void 0===e||e.removeWidget(this._loaderHost)}),100)):B()},spectaConfig:this._spectaAppConfig})}onCloseRequest(e){this._model.dispose(),super.onCloseRequest(e)}_onSelectedLayoutChanged(e,t){var o;const{layout:n}=t;[...this._host.widgets].forEach((e=>{var t;null===(t=this._host.layout)||void 0===t||t.removeWidget(e)})),n.render({host:this._host,items:this._outputs,notebook:null===(o=this._model.context)||void 0===o?void 0:o.model.toJSON(),readyCallback:async()=>{},spectaConfig:this._spectaAppConfig})}}class F{constructor(e){this._options=e}async createNew(e){var t,o;const{context:n}=e,a=this._options.rendermime.clone({resolver:n.urlResolver}),s=H({nbMetadata:n.model.metadata,nbPath:null===(t=n.contentsModel)||void 0===t?void 0:t.path}),i=null!==(o=s.defaultLayout)&&void 0!==o?o:"default";this._options.spectaLayoutRegistry.setSelectedLayout(i);const l=new R({context:n,manager:this._options.manager,rendermime:a,tracker:this._options.tracker,contentFactory:this._options.contentFactory,mimeTypeService:this._options.mimeTypeService,editorConfig:r.StaticNotebook.defaultEditorConfig,notebookConfig:r.StaticNotebook.defaultNotebookConfig,editorServices:this._options.editorServices});return new W({id:p.UUID.uuid4(),label:"",model:l,layoutRegistry:this._options.spectaLayoutRegistry,spectaConfig:s})}}var I=function(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(o[n[a]]=e[n[a]])}return o};function q(e){const{factoryName:t,app:o,rendermime:n,tracker:a,editorServices:s,contentFactory:i,spectaTracker:l,spectaLayoutRegistry:r,themeManager:c}=e,d=new F({manager:o.serviceManager,rendermime:n,tracker:a,contentFactory:i,mimeTypeService:s.mimeTypeService,editorServices:s,spectaLayoutRegistry:r}),u=new S({name:t,modelName:"notebook",fileTypes:["notebook"],shell:o.shell,spectaWidgetFactory:d,themeManager:c,spectaLayoutRegistry:r});o.docRegistry.addWidgetFactory(u),u.widgetCreated.connect(((e,t)=>{t.context.pathChanged.connect((()=>{l.save(t)})),l.add(t)}))}function A(e){const{defaultBrowser:t}=e,o=t;o.singleClickNavigation=!0,o.showFileCheckboxes=!1,o.showLastModifiedColumn=!1,o.addClass("specta-file-browser");const n=o.listing.handleOpen.bind(o.listing);return o.listing.handleOpen=e=>{"directory"!==e.type?window.open((e=>{const t=s.PageConfig.getBaseUrl();let o=s.PageConfig.getOption("appUrl");o.endsWith("/")||(o=`${o}/`);const n=new URL(s.URLExt.join(t,o));return n.searchParams.set("path",e),s.PageConfig.getOption("query").split("&").filter(Boolean).forEach((e=>{const[t,o]=e.split("=");n.searchParams.set(t,o)})),n.toString()})(e.path),"_blank"):n(e)},o}function B(){const e=document.getElementById("specta-loader-host"),t=document.getElementById("specta-loader-spinner");e&&t&&(e.style.opacity="0",setTimeout((()=>{t.remove(),e.remove(),document.body.classList.remove("jp-mod-dark","jp-mod-light")}),1e3))}function D(...e){const t={};for(const o of e)for(const[e,n]of Object.entries(o))null!=n&&(t[e]=n);return t}function U(e){const t=s.PageConfig.getOption("fullLabextensionsUrl");return s.URLExt.join(t,"jupyter-specta","static",e)}function z(){return!!document.querySelector('meta[name="specta-config"]')}function H({nbMetadata:e,nbPath:t}){var o;let n=s.PageConfig.getOption("spectaConfig");n&&0!==n.length||(n="{}");let a=t;const i=null==t?void 0:t.split(":");i&&i.length>1&&(a=i[1]);const l=JSON.parse(n),{perFileConfig:r}=l,c=I(l,["perFileConfig"]);let d=Object.assign({},null!=c?c:{});r&&a&&r[a]&&(d=Object.assign(Object.assign({},d),r[a]));const u=null!==(o=null==e?void 0:e.specta)&&void 0!==o?o:{};return"Yes"===u.hideTopbar?u.hideTopbar=!0:"No"===u.hideTopbar&&(u.hideTopbar=!1),D(d,u)}function J(e){var t,o;const n=null!==(o=null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.specta)&&void 0!==o?o:{},a={showSource:!1,showOutput:!0};return n.showSource&&"Yes"===n.showSource&&(a.showSource=!0),n.showOutput&&"No"===n.showOutput&&(a.showOutput=!1),a}function $(e,t=100){let o;return(...n)=>{clearTimeout(o),o=setTimeout((()=>{e(...n)}),t)}}const Z=$((()=>{window.dispatchEvent(new Event("resize"))}));function K(e){let t=document.getElementById("reveal-theme");t||(t=document.createElement("link"),t.rel="stylesheet",t.id="reveal-theme",document.head.appendChild(t)),t.href=U(`reveal.js/${e}.css`)}const Y={id:"specta:notebook-doc",autoStart:!0,requires:[c.IRenderMimeRegistry,r.INotebookTracker,a.IEditorServices,r.NotebookPanel.IContentFactory,h,n.IThemeManager],activate:(e,t,o,a,s,i,l)=>{const r=new n.WidgetTracker({namespace:"specta"});return q({factoryName:"specta",app:e,rendermime:t,tracker:o,editorServices:a,contentFactory:s,spectaTracker:r,spectaLayoutRegistry:i,themeManager:l}),r},provides:m},G={id:"specta/application-extension:opener",autoStart:!0,requires:[i.IDocumentManager,l.IDefaultFileBrowser,m,d.IKernelSpecManager],activate:async(e,t,o)=>{if(!z())return;const n=new URLSearchParams(window.location.search).get("path");if(n)if(".ipynb"===s.PathExt.extname(n)){e.shell.addClass("specta-document-viewer");const o=t.openOrReveal(n,"specta");o&&e.shell.add(o,"main")}else{let o=0;const a=()=>{const s=t.openOrReveal(n,"default");if(s)e.shell.add(s,"main"),B();else{if(o++,o>10){console.error("Failed to open file",n);const t=new u.Widget;return t.node.innerHTML=`<h2 style="text-align: center; margin-top: 200px;">Failed to open file ${n}</h2>`,e.shell.add(t,"main"),void B()}setTimeout(a,100)}};a()}else{const t=A({defaultBrowser:o});e.shell.add(t,"main",{rank:100}),B()}}};var V=o(4602);class Q{async render(e){const{host:t,items:o,readyCallback:n}=e;for(const e of o){const o=e.info.cellModel,n=e.info;null==o||o.cell_type,n.hidden||t.addWidget(e)}await n()}}class X extends u.Panel{constructor(){super(),this.addClass("specta-article-host-widget"),this._outputs=new u.Panel,this._outputs.addClass("specta-article-outputs-panel"),this.addWidget(this._outputs)}addOutput(e){this._outputs.addWidget(e)}}class ee{async render(e){const{host:t,items:o,readyCallback:n}=e,a=new X;for(const e of o){const t=e.info.cellModel,o=e.info;null==t||t.cell_type,o.hidden||a.addOutput(e)}t.addWidget(a),await n()}}var te=o(3268),oe=o.n(te);class ne extends u.Panel{constructor(){super(),this.addClass("specta-slides-host-widget"),this.addClass("reveal"),this._outputs=new u.Panel,this._outputs.addClass("slides"),this.addWidget(this._outputs)}addOutput(e){const{type:t,widget:o}=e,n=new u.Widget({node:document.createElement("section")});switch(t){case"slide":{const e=o[0];n.node.appendChild(e.node),e.parent=n,n.processMessage=t=>{e.processMessage(t)};break}case"subslide":for(const e of o){const t=document.createElement("section");t.appendChild(e.node),e.parent=n,n.node.appendChild(t)}n.processMessage=e=>{o.forEach((t=>t.processMessage(e)))};break;case"fragment":for(const[e,t]of o.entries())0!==e&&(t.addClass("fragment"),t.addClass("fade-in")),n.node.appendChild(t.node),t.parent=n;n.processMessage=e=>{o.forEach((t=>t.processMessage(e)))}}this._outputs.addWidget(n)}}class ae{constructor(){this._deckMap=new WeakMap}async render(e){var t,o,n;const a=e.spectaConfig.slidesTheme;a&&K(a);const{host:s,items:i,readyCallback:l}=e,r=new ne,c=[];for(const e of i){const a=e.info,s=null!==(o=null===(t=a.cellModel)||void 0===t?void 0:t.metadata)&&void 0!==o?o:{},i=null===(n=null==s?void 0:s.slideshow)||void 0===n?void 0:n.slide_type;if(!a.hidden){const t=c[c.length-1];switch(i){case"subslide":"subslide"===(null==t?void 0:t.type)?t.widget.push(e):c.push({type:"subslide",widget:[e]});break;case"fragment":"fragment"===(null==t?void 0:t.type)?t.widget.push(e):c.push({type:"fragment",widget:[e]});break;default:c.push({type:"slide",widget:[e]})}}}for(const e of c)r.addOutput(e);s.addWidget(r),await l();const d=new(oe())(r.node,{embedded:!0});d.initialize(),d.on("slidetransitionend",(e=>{Z()})),this._deckMap.set(s.node,d)}}class se{constructor(){this._registry=new Map,this._layoutAdded=new V.Signal(this),this._selectedLayoutChanged=new V.Signal(this);const e=new Q;this._registry=new Map,this._registry.set("default",e),this._registry.set("article",new ee),this._registry.set("slides",new ae),this._selectedLayout={name:"default",layout:e}}get layoutAdded(){return this._layoutAdded}get selectedLayout(){return this._selectedLayout}get selectedLayoutChanged(){return this._selectedLayoutChanged}get(e){return this._registry.get(e)}getDefaultLayout(){return this._registry.get("default")}async setSelectedLayout(e){if(!this._registry.has(e))throw new Error(`Layout with name ${e} does not exist`);const t=this._selectedLayout.layout;this._selectedLayout={name:e,layout:this._registry.get(e)},this._selectedLayoutChanged.emit(Object.assign(Object.assign({},this._selectedLayout),{oldLayout:t}))}register(e,t){if(this._registry.has(e))throw new Error(`Layout with name ${e} already exists`);this._registry.set(e,t),this._layoutAdded.emit(e)}allLayouts(){return Array.from(this._registry.keys())}}const ie=[Y,G,{id:"specta:layout-registry",autoStart:!0,provides:h,activate:e=>{var t;const o=new se,n=null!==(t=H({}).defaultLayout)&&void 0!==t?t:"default";return o.setSelectedLayout(n),o}},{id:"specta:topbar",description:"Specta topbar extension",autoStart:!0,requires:[n.IThemeManager,h],activate:(e,t,o)=>{if(!z())return;const n=new URLSearchParams(window.location.search).get("path");if(n&&".ipynb"===s.PathExt.extname(n))return;const a=H({nbPath:n});if(a.hideTopbar)return void e.shell.hideTopBar();const i=y.ReactWidget.create(v.createElement(k,{config:a.topBar,themeManager:t,layoutRegistry:o}));i.id="specta-topbar-widget",i.addClass("specta-topbar-element"),e.shell.add(i,"top")}},{id:"jupyter-specta:app-meta",autoStart:!0,activate:e=>{}},{id:"jupyter-specta:cell-meta",autoStart:!0,activate:e=>{}}]}}]);