# -*- coding: utf-8 -*-

"""
whatsappcloudapi

This file was automatically generated by APIMATIC v3.0 (
 https://www.apimatic.io ).
"""

from whatsappcloudapi.api_helper import APIHelper
from whatsappcloudapi.configuration import Server
from whatsappcloudapi.controllers.base_controller import BaseController
from apimatic_core.request_builder import RequestBuilder
from apimatic_core.response_handler import ResponseHandler
from apimatic_core.types.parameter import Parameter
from whatsappcloudapi.http.http_method_enum import HttpMethodEnum
from apimatic_core.authentication.multiple.single_auth import Single
from whatsappcloudapi.models.get_phone_numbers import GetPhoneNumbers
from whatsappcloudapi.models.get_phone_number_by_id import GetPhoneNumberByID
from whatsappcloudapi.models.get_display_name_status_beta import GetDisplayNameStatusBeta
from whatsappcloudapi.models.request_verification_code import RequestVerificationCode
from whatsappcloudapi.models.verify_code import VerifyCode
from whatsappcloudapi.models.set_two_step_verification_code import SetTwoStepVerificationCode


class PhoneNumbersController(BaseController):

    """A Controller to access Endpoints in the whatsappcloudapi API."""
    def __init__(self, config):
        super(PhoneNumbersController, self).__init__(config)

    def get_phone_numbers(self,
                          waba_id):
        """Does a GET request to /{WABA-ID}/phone_numbers.

        This API returns all phone numbers in a WhatsApp Business Account
        specified by the **`{{WABA-ID}}`** value. Get the **`id`** value for
        the phone number you want to use to send messages with WhatsApp
        Business Cloud API.
        #### Response Parameters
        | Name                  | Description                 |
        |-----------------------|-----------------------------|
        | **`verified_name`**         | The verified name associated with the
        phone number.  |
        | **`display_phone_number`**  | The string representation of the phone
        number.       |
        | **`id`**                    | The ID associated with the phone
        number.                            |
        | **`quality_rating`**        | The quality rating of the phone number
        based on how messages have been received by recipients in recent days.
        Valid values are: <br/><ul><li>**`Green`**: High
        Quality</li><li>**`Yellow`**: Medium Quality</li><li>**`Red`**: Low
        Quality</li><li>**`NA`**: Quality has not been determined</li></ul> 
        <br/>For more information relating to quality rating, see [About
        WhatsApp Business Account Message Quality
        Rating](https://www.facebook.com/business/help/896873687365001).      
        |

        Args:
            waba_id (str): The request template parameter.

        Returns:
            GetPhoneNumbers: Response from the API.

        Raises:
            APIException: When an error occurs while fetching the data from
                the remote API. This exception includes the HTTP Response
                code, an error message, and the HTTP body that was received in
                the request.

        """

        return super().new_api_call_builder.request(
            RequestBuilder().server(Server.SERVER_1)
            .path('/{WABA-ID}/phone_numbers')
            .http_method(HttpMethodEnum.GET)
            .template_param(Parameter()
                            .key('WABA-ID')
                            .value(waba_id)
                            .should_encode(True))
            .header_param(Parameter()
                          .key('accept')
                          .value('application/json'))
            .auth(Single('bearer'))
        ).response(
            ResponseHandler()
            .deserializer(APIHelper.json_deserialize)
            .deserialize_into(GetPhoneNumbers.from_dictionary)
        ).execute()

    def get_phone_number_by_id(self,
                               phone_number_id):
        """Does a GET request to /{Phone-Number-ID}.

        When you query all the phone numbers for a WhatsApp Business Account,
        each phone number has an **`id`**. You can directly query for a phone
        number using this **`id`**.
        #### Response Parameters
        | Name                  | Description                 |
        |-----------------------|-----------------------------|
        | **`verified_name`**         | The verified name associated with the
        phone number.  |
        | **`display_phone_number`**  | The string representation of the phone
        number.       |
        | **`id`**                    | The ID associated with the phone
        number.                            |
        | **`quality_rating`**        | The quality rating of the phone number
        based on how messages have been received by recipients in recent days.
        Valid values are: <br/><ul><li>**`Green`**: High
        Quality</li><li>**`Yellow`**: Medium Quality</li><li>**`Red`**: Low
        Quality</li><li>**`NA`**: Quality has not been determined</li></ul> 
        <br/>For more information relating to quality rating, see [About
        WhatsApp Business Account Message Quality
        Rating](https://www.facebook.com/business/help/896873687365001).      
        |

        Args:
            phone_number_id (str): The request template parameter.

        Returns:
            GetPhoneNumberByID: Response from the API.

        Raises:
            APIException: When an error occurs while fetching the data from
                the remote API. This exception includes the HTTP Response
                code, an error message, and the HTTP body that was received in
                the request.

        """

        return super().new_api_call_builder.request(
            RequestBuilder().server(Server.SERVER_1)
            .path('/{Phone-Number-ID}')
            .http_method(HttpMethodEnum.GET)
            .template_param(Parameter()
                            .key('Phone-Number-ID')
                            .value(phone_number_id)
                            .should_encode(True))
            .header_param(Parameter()
                          .key('accept')
                          .value('application/json'))
            .auth(Single('bearer'))
        ).response(
            ResponseHandler()
            .deserializer(APIHelper.json_deserialize)
            .deserialize_into(GetPhoneNumberByID.from_dictionary)
        ).execute()

    def get_display_name_status_beta(self,
                                     fields,
                                     phone_number_id):
        """Does a GET request to /{Phone-Number-ID}.

        Include **`fields=name_status`** as a query string parameter to get
        the status of a display name associated with a specific phone number.
        This field is currently in beta and not available to all developers.

        Args:
            fields (str): The status of a display name associated with a
                specific phone number. The **`name_status`** value can be one
                of the following:  * `APPROVED`: The name has been approved.
                You can download your certificate now. *
                `AVAILABLE_WITHOUT_REVIEW`: The certificate for the phone is
                available and display name is ready to use without review. *
                `DECLINED`: The name has not been approved. You cannot
                download your certificate. * `EXPIRED`: Your certificate has
                expired and can no longer be downloaded. * `PENDING_REVIEW`:
                Your name request is under review. You cannot download your
                certificate. NONE: No certificate is available.
            phone_number_id (str): The request template parameter.

        Returns:
            GetDisplayNameStatusBeta: Response from the API.

        Raises:
            APIException: When an error occurs while fetching the data from
                the remote API. This exception includes the HTTP Response
                code, an error message, and the HTTP body that was received in
                the request.

        """

        return super().new_api_call_builder.request(
            RequestBuilder().server(Server.SERVER_1)
            .path('/{Phone-Number-ID}')
            .http_method(HttpMethodEnum.GET)
            .query_param(Parameter()
                         .key('fields')
                         .value(fields))
            .template_param(Parameter()
                            .key('Phone-Number-ID')
                            .value(phone_number_id)
                            .should_encode(True))
            .header_param(Parameter()
                          .key('accept')
                          .value('application/json'))
            .auth(Single('bearer'))
        ).response(
            ResponseHandler()
            .deserializer(APIHelper.json_deserialize)
            .deserialize_into(GetDisplayNameStatusBeta.from_dictionary)
        ).execute()

    def get_phone_numbers_with_filtering_beta(self,
                                              fields,
                                              filtering,
                                              waba_id):
        """Does a GET request to /{WABA-ID}/phone_numbers.

        - Guide: [Filter Phone
        Numbers](https://developers.facebook.com/docs/whatsapp/business-managem
        ent-api/manage-phone-numbers#filter-phone-numbers)
        - Endpoint reference: [WhatsApp Business Account > Phone
        Numbers](https://developers.facebook.com/docs/graph-api/reference/whats
        -app-business-account/phone_numbers/)

        Args:
            fields (str): The request query parameter.
            filtering (List[Filtering]): The request query parameter.
            waba_id (str): The request template parameter.

        Returns:
            void: Response from the API.

        Raises:
            APIException: When an error occurs while fetching the data from
                the remote API. This exception includes the HTTP Response
                code, an error message, and the HTTP body that was received in
                the request.

        """

        return super().new_api_call_builder.request(
            RequestBuilder().server(Server.SERVER_1)
            .path('/{WABA-ID}/phone_numbers')
            .http_method(HttpMethodEnum.GET)
            .query_param(Parameter()
                         .key('fields')
                         .value(fields))
            .query_param(Parameter()
                         .key('filtering')
                         .value(filtering))
            .template_param(Parameter()
                            .key('WABA-ID')
                            .value(waba_id)
                            .should_encode(True))
            .auth(Single('bearer'))
        ).execute()

    def request_verification_code(self,
                                  body,
                                  phone_number_id):
        """Does a POST request to /{Phone-Number-ID}/request_code.

        You need to verify the phone number you want to use to send messages
        to your customers. Phone numbers must be verified through SMS/voice
        call. The verification process can be done through the Graph API calls
        specified below.

        To verify a phone number using Graph API, make a **POST** request to
        **`{{PHONE_NUMBER_ID}}/request_code`**. In your call, include your
        chosen verification method and locale. You need to authenticate
        yourself using **{{User-Access-Token}}** (This is automatically done
        for you in the **`Request Verification Code`** request).
        #### Request Parameters
        | Name                  | Description                 |
        |-----------------------|-----------------------------|
        | **`code_method`**         | **Required**.<br/>Specifies the method
        for verification. Supported options are: `SMS` or `VOICE`.  |
        | **`locale`**         | **Required**.<br/>Specifies your locale. For
        instance: `"en_US"`.  |
        #### Response
        After a successful call to **`Request Verification Code`**, you will
        receive your verification code via the method you selected in
        **`code_method`**. To finish the verification process, you need to use
        the [**`Verify
        Code`**](https://developers.facebook.com/docs/whatsapp/cloud-api/refere
        nce/phone-numbers#verify) request.

        Args:
            body (RequestVerificationCodeRequest): The request body parameter.
            phone_number_id (str): The request template parameter.

        Returns:
            RequestVerificationCode: Response from the API.

        Raises:
            APIException: When an error occurs while fetching the data from
                the remote API. This exception includes the HTTP Response
                code, an error message, and the HTTP body that was received in
                the request.

        """

        return super().new_api_call_builder.request(
            RequestBuilder().server(Server.SERVER_1)
            .path('/{Phone-Number-ID}/request_code')
            .http_method(HttpMethodEnum.POST)
            .header_param(Parameter()
                          .key('Content-Type')
                          .value('application/json'))
            .body_param(Parameter()
                        .value(body))
            .template_param(Parameter()
                            .key('Phone-Number-ID')
                            .value(phone_number_id)
                            .should_encode(True))
            .header_param(Parameter()
                          .key('accept')
                          .value('application/json'))
            .body_serializer(APIHelper.json_serialize)
            .auth(Single('bearer'))
        ).response(
            ResponseHandler()
            .deserializer(APIHelper.json_deserialize)
            .deserialize_into(RequestVerificationCode.from_dictionary)
        ).execute()

    def verify_code(self,
                    body,
                    phone_number_id):
        """Does a POST request to /{Phone-Number-ID}/verify_code.

        After you received a SMS or Voice request code from [**`Request
        Verification
        Code`**](https://developers.facebook.com/docs/whatsapp/cloud-api/refere
        nce/phone-numbers#verify), you need to verify the code that was sent
        to you. To verify this code, make a **POST** request to
        **`{{PHONE_NUMBER_ID}}/verify_code`** that includes the code as a
        parameter.
        #### Request Parameters
        | Name                  | Description                 |
        |-----------------------|-----------------------------|
        | **`code`**<br/>type: Numeric String | **Required**.<br/>The code you
        received after calling [**`Request Verification
        Code`**](https://developers.facebook.com/docs/whatsapp/cloud-api/refere
        nce/phone-numbers#verify)(**`{{PHONE_NUMBER_ID}}/request_code`**).  |

        Args:
            body (VerifyCodeRequest): The request body parameter.
            phone_number_id (str): The request template parameter.

        Returns:
            VerifyCode: Response from the API.

        Raises:
            APIException: When an error occurs while fetching the data from
                the remote API. This exception includes the HTTP Response
                code, an error message, and the HTTP body that was received in
                the request.

        """

        return super().new_api_call_builder.request(
            RequestBuilder().server(Server.SERVER_1)
            .path('/{Phone-Number-ID}/verify_code')
            .http_method(HttpMethodEnum.POST)
            .header_param(Parameter()
                          .key('Content-Type')
                          .value('application/json'))
            .body_param(Parameter()
                        .value(body))
            .template_param(Parameter()
                            .key('Phone-Number-ID')
                            .value(phone_number_id)
                            .should_encode(True))
            .header_param(Parameter()
                          .key('accept')
                          .value('application/json'))
            .body_serializer(APIHelper.json_serialize)
            .auth(Single('bearer'))
        ).response(
            ResponseHandler()
            .deserializer(APIHelper.json_deserialize)
            .deserialize_into(VerifyCode.from_dictionary)
        ).execute()

    def set_two_step_verification_code(self,
                                       body,
                                       phone_number_id):
        """Does a POST request to /{Phone-Number-ID}.

        You can use this endpoint to change two-step verification code
        associated with your account. 
        After you change the verification code, future requests like changing
        the name, must use the new code. 
        **You set up two-factor verification and [register a phone
        number](https://developers.facebook.com/docs/whatsapp/cloud-api/referen
        ce/registration#register-phone) in the same API call.**
        You must use the parameters listed below to change two-step
        verification 
        ## Parameters
        | Name          |  Description   |
        |-------------- |--------------- |
        | **`pin`**   | **Required**.<br/> A 6-digit PIN you want to use for
        two-step verification. |

        Args:
            body (SetTwoStepVerificationCodeRequest): The request body
                parameter.
            phone_number_id (str): The request template parameter.

        Returns:
            SetTwoStepVerificationCode: Response from the API.

        Raises:
            APIException: When an error occurs while fetching the data from
                the remote API. This exception includes the HTTP Response
                code, an error message, and the HTTP body that was received in
                the request.

        """

        return super().new_api_call_builder.request(
            RequestBuilder().server(Server.SERVER_1)
            .path('/{Phone-Number-ID}')
            .http_method(HttpMethodEnum.POST)
            .header_param(Parameter()
                          .key('Content-Type')
                          .value('application/json'))
            .body_param(Parameter()
                        .value(body))
            .template_param(Parameter()
                            .key('Phone-Number-ID')
                            .value(phone_number_id)
                            .should_encode(True))
            .header_param(Parameter()
                          .key('accept')
                          .value('application/json'))
            .body_serializer(APIHelper.json_serialize)
            .auth(Single('bearer'))
        ).response(
            ResponseHandler()
            .deserializer(APIHelper.json_deserialize)
            .deserialize_into(SetTwoStepVerificationCode.from_dictionary)
        ).execute()
